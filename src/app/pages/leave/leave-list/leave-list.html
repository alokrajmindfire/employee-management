<div class="max-w-5xl mx-auto p-4 sm:p-6 lg:p-8">
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
    <h2 class="text-2xl font-semibold text-gray-700 dark:text-gray-50 mb-4 sm:mb-0">
      Leave Requests
    </h2>
    <a
      [routerLink]="'/leaves/apply'"
      routerLinkActive="bg-blue-600 text-white"
      [routerLinkActiveOptions]="{ exact: true }"
      class="px-4 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition w-full sm:w-auto text-center"
    >
      Apply for Leave
    </a>
  </div>

  @if (leaveService.loading()) {
    <div class="text-center py-6 text-gray-500 dark:text-gray-300">Loading...</div>
  } @else {
    <div class="space-y-4">
      @for (leave of leaveService.leaves(); track $index) {
        <div
          class="border rounded-lg p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition"
        >
          <div class="flex-1 mb-3 sm:mb-0">
            <p class="font-medium text-gray-700 dark:text-gray-50">{{ leave.type }} Leave</p>
            <p class="text-sm text-gray-500 dark:text-gray-300 mt-1 max-w-[30rem]">
              {{ leave.date | leave }} - {{ leave.reason }}
            </p>
            <span
              [ngClass]="{
                'text-yellow-500': leave.status === 'Pending',
                'text-green-600': leave.status === 'Approved',
                'text-red-600': leave.status === 'Rejected',
              }"
              class="text-sm font-semibold mt-1 inline-block"
            >
              {{ leave.status }}
            </span>
          </div>

          <div class="flex flex-wrap gap-2">
            <button
              (click)="approve(leave.id!)"
              [disabled]="leave.status === 'Approved' || !roleService.isAdmin()"
              [ngClass]="
                leave.status === 'Approved' || !roleService.isAdmin()
                  ? 'bg-green-300 cursor-not-allowed'
                  : 'bg-green-500 hover:bg-green-600'
              "
              class="px-3 py-1 bg-green-500 text-white rounded-lg hover:bg-green-600 transition w-full sm:w-auto"
            >
              Approve
            </button>
            <button
              (click)="reject(leave.id!)"
              [disabled]="leave.status === 'Rejected' || !roleService.isAdmin()"
              [ngClass]="
                leave.status === 'Rejected' || !roleService.isAdmin()
                  ? 'bg-green-300 cursor-not-allowed'
                  : 'bg-green-500 hover:bg-green-600'
              "
              class="px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition w-full sm:w-auto"
            >
              Reject
            </button>
            <button
              (click)="remove(leave.id!)"
              class="px-3 py-1 bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition w-full sm:w-auto"
            >
              Delete
            </button>
          </div>
        </div>
      }
    </div>
  }
</div>
