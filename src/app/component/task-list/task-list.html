<div class="dark:bg-gray-800 dark:text-white">
  @if (store.loading()) {
    <app-loader message="Loading tasks..." />
  } @else if (store.tasks().length === 0) {
    <div class="text-gray-500 text-center">No tasks found.</div>
  } @else {
    <ul class="space-y-2">
      @for (task of store.tasks(); track task.id) {
        <li class="flex justify-between items-center p-2 border rounded">
          <div class="flex items-center gap-2">
            <input
              [id]="'task-' + task.id"
              [name]="'task-' + task.id"
              type="checkbox"
              [checked]="task.completed"
              (change)="store.toggleTask(task.id)"
              class="w-4 h-4 accent-blue-600"
              name=""
            />

            @if (editMode() === task.id) {
              <input
                [(ngModel)]="editTitle"
                class="border px-2 py-1 rounded w-60"
                placeholder="Edit title"
              />
            } @else {
              <label
                [class.line-through]="task.completed"
                [class.text-gray-400]="task.completed"
                class="cursor-pointer"
                [for]="'task-' + task.id"
              >
                {{ task.title }}
              </label>
            }
          </div>

          <div class="flex gap-2">
            @if (editMode() === task.id) {
              <button class="text-green-600 hover:underline" (click)="saveEdit(task.id)">
                Save
              </button>
              <button class="text-gray-600 hover:underline" (click)="cancelEdit()">Cancel</button>
            } @else {
              <button
                class="text-blue-600 hover:underline disabled:text-gray-400 disabled:cursor-not-allowed"
                [disabled]="task.completed"
                (click)="startEdit(task.id, task.title)"
              >
                Edit
              </button>

              <button class="text-red-600 hover:underline" (click)="deleteTask(task.id)">
                Delete
              </button>
            }
          </div>
        </li>
      }
    </ul>
  }
</div>
